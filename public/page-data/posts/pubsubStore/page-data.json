{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/pubsubStore","result":{"data":{"markdownRemark":{"id":"7c3040d7-0ac6-53d5-837c-fb7506f47632","html":"<p>&#x3C;작성중></p>\n<h1 id=\"pubsub-state\" style=\"position:relative;\"><a href=\"#pubsub-state\" aria-label=\"pubsub state permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PubSub-State</h1>\n<blockquote>\n<h3 id=\"bold-pubsub-패턴에-영감을-받은-앱의-데이터-상태를-관리하는-라이브러리-bold\" style=\"position:relative;\"><a href=\"#bold-pubsub-%ED%8C%A8%ED%84%B4%EC%97%90-%EC%98%81%EA%B0%90%EC%9D%84-%EB%B0%9B%EC%9D%80-%EC%95%B1%EC%9D%98-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%83%81%ED%83%9C%EB%A5%BC-%EA%B4%80%EB%A6%AC%ED%95%98%EB%8A%94-%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC-bold\" aria-label=\"bold pubsub 패턴에 영감을 받은 앱의 데이터 상태를 관리하는 라이브러리 bold permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><bold> PubSub 패턴에 영감을 받은 앱의 데이터 상태를 관리하는 라이브러리 </bold></h3>\n</blockquote>\n<hr>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">다중 함수가 같은 출처의 동적 데이터에 접근하고 있다면, 어떻게 이 데이터의 변화를 추적하며 관리를 하면 좋을까요. </code></pre></div>\n<ul>\n<li>우선 데이터를 만들어내는 주체와, 그 데이터를 사용하며,\n의존하는 주체를 분리하여 커플링이 일어나지 않아야 한다고 생각합니다.</li>\n<li>다중 함수가 오리진이 같은 데이터를 사용한다면, 그 말은 곧 함수는 동기화 된 최신의 데이터를 가지거나,\n일회성으로 Props형식으로 데이터를 자식으로 넘겨줍니다.</li>\n<li>특정 주제로 묶은 데이터의 집합을 원하는 함수에게만 전달하고, 데이터가 함수에 전달 된 후,\n함수가 호출되는 파이프를 만들어, 중간에 불필요한 기능적 간섭을 줄입니다.</li>\n<li>위에서 언급한 바와 같이 데이터를 발행하는 주체는 데이터를 받는 주체를 몰라도 됩니다.\n단지 발행자와 구독자 사이에는 데이터를 저장하는 상태 저장소와 메세지를 전달하는 브로커가 존재할 뿐입니다. </li>\n<li>구독자 함수는 그저 함수의 기능에만 집중합니다 (Reactive), 구독하는 데이터가 변경되었을 시 알아차리기만 하면 됩니다. (Ack) </li>\n<li>추가적으로 함수가 데이터를 구독하고, 메세지를 수신하고, 수신한 데이터를 사용하고,\n새로운 데이터를 요청하는 상태를 저장소에 함께 저장한다면, 더 세밀하게 데이터의 변화주기를 추적할 수 있다고 생각합니다.</li>\n</ul>\n<p>전역 변수를 사용하지 않기 위해, 그리고 공유하는 자원의 변화를 추적하는 여러 방법들을 찾아 보던 중,</br>\n네트워크 방법론의 뿌리를 가진 PubSub Messaging 패턴을 알게 되었습니다.\n( 이는 프론트엔드 프레임워크/라이브러리 상태관리 패턴인 Flux의 기반이 됩니다. )</p>\n<p>5월 23일을 기준으로 작성한 코드입니다.\n최신 버전은 블로그 글 마무리 전까지는 여기서 확인 부탁드립니다.</p>\n<blockquote>\n<p><a href=\"https://github.com/pikpokjeon/PubSub-State\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">PubSub-State 저장소</a></p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> pipe <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./helper.js'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">/**\n * \n * @param {*} msg 개수에 상관없이 [] 배열에 초기에 저장할 객체 전달\n * @param {*} sub 스토어를 구독할 구독자(함수)를 배열에 담아 전달\n */</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Store</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">msg<span class=\"token punctuation\">,</span> sub</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n<span class=\"token punctuation\">{</span>\n\n    <span class=\"token comment\">// 메세지 저장 객체</span>\n    <span class=\"token keyword\">let</span> _store <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">ack</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span> <span class=\"token parameter\"><span class=\"token punctuation\">{</span>topics<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> topics<span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">_<span class=\"token punctuation\">,</span> topic</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>   <span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span>_store<span class=\"token punctuation\">[</span>topic<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>data <span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>_store<span class=\"token punctuation\">[</span>topic<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>subs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">subscribe</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> topics<span class=\"token punctuation\">,</span> sub <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> topic <span class=\"token keyword\">of</span> topics<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            _store<span class=\"token punctuation\">[</span>topic<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>subs<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>sub<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> topics <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getData</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">store</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">topic</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> store<span class=\"token punctuation\">[</span>topic<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>data</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">setData</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">msgs<span class=\"token punctuation\">,</span> sub</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> \n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> topics <span class=\"token operator\">=</span> msgs<span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">acc<span class=\"token punctuation\">,</span> cur</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">const</span> prevStore <span class=\"token operator\">=</span> _store<span class=\"token punctuation\">[</span>cur<span class=\"token punctuation\">.</span>topic<span class=\"token punctuation\">]</span>\n\n            <span class=\"token keyword\">const</span> temp <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token punctuation\">[</span>cur<span class=\"token punctuation\">.</span>topic<span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                    data<span class=\"token operator\">:</span> prevStore <span class=\"token operator\">?</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>prevStore<span class=\"token punctuation\">[</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>cur<span class=\"token punctuation\">.</span>data <span class=\"token punctuation\">}</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>cur<span class=\"token punctuation\">.</span>data <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                    subs<span class=\"token operator\">:</span> prevStore <span class=\"token operator\">?</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span>prevStore<span class=\"token punctuation\">[</span><span class=\"token string\">'subs'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n\n            Object<span class=\"token punctuation\">.</span><span class=\"token function\">assign</span><span class=\"token punctuation\">(</span>_store<span class=\"token punctuation\">,</span> temp<span class=\"token punctuation\">)</span>\n            acc<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>cur<span class=\"token punctuation\">.</span>topic<span class=\"token punctuation\">)</span>\n\n            <span class=\"token keyword\">return</span> acc\n\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>topics<span class=\"token punctuation\">,</span> sub<span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    \n\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">pubSubPipe</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">msgs<span class=\"token punctuation\">,</span> subs</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span> <span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span> <span class=\"token function\">setData</span><span class=\"token punctuation\">(</span>msgs<span class=\"token punctuation\">,</span> subs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> subscribe<span class=\"token punctuation\">,</span> ack <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">]</span>\n\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> setData<span class=\"token punctuation\">,</span> pubSubPipe<span class=\"token punctuation\">,</span> subscribe<span class=\"token punctuation\">,</span> ack<span class=\"token punctuation\">,</span> getData<span class=\"token operator\">:</span> <span class=\"token function\">getData</span><span class=\"token punctuation\">(</span>_store<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">/**\n * Store 생성자를 초기화 때와 분리한다\n * @param {*} msgs 데이터 정보\n * @param {*} subs 데이터를 구독하는 함수\n *   \n */</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">store</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">msgs<span class=\"token punctuation\">,</span> subs</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> pubSubStore <span class=\"token operator\">=</span> <span class=\"token function\">Store</span><span class=\"token punctuation\">(</span>msgs<span class=\"token punctuation\">,</span> subs<span class=\"token punctuation\">)</span>\n    pubSubStore<span class=\"token punctuation\">.</span><span class=\"token function\">pubSubPipe</span><span class=\"token punctuation\">(</span>msgs<span class=\"token punctuation\">,</span> subs<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">return</span> pubSubStore\n\n<span class=\"token punctuation\">}</span></code></pre></div>","fields":{"slug":"/posts/pubsubStore","tagSlugs":["/tag/pattern/","/tag/javascript/","/tag/functional-programming/","/tag/reactive/","/tag/pub-sub/","/tag/상태관리/"]},"frontmatter":{"date":"2021-05-25T22:40:32.169Z","description":"Publish-Subscribe messaging pattern과 함수형 패러다임을 이용한 간단한 프론트엔드 프로젝트 상태관리 라이브러리 개발과정","tags":["Pattern","Javascript","functional programming","reactive","PubSub","상태관리"],"title":"[Project-lib] PubSub 함수형 상태관리 패턴"}}},"pageContext":{"slug":"/posts/pubsubStore"}},"staticQueryHashes":["1140640941","251939775","401334301"]}